pkg load symbolic
syms s

% Параметры дуг (M, D, P)
edges = {
    1, 2, 37, 16, 0.7;
    1, 3, 10, 4, 0.3;
    2, 4, 17, 9, 1.0;
    3, 3, 23, 25, 0.6;
    3, 4, 53, 36, 0.1;
    3, 5, 14, 9, 0.3;
    4, 1, 37, 16, 0.2;
    4, 6, 42, 9, 0.8;
    5, 2, 35, 4, 0.7;
    5, 6, 22, 9, 0.3;
};

% Упрощенная передаточная функция W_E(s)
W_num = 0.7 / (1 - (16/37)*s)^(37^2/16) * ...
        1.0 / (1 - (9/17)*s)^(17^2/9) * ...
        0.8 / (1 - (9/42)*s)^(42^2/9) + ...
        0.3 / (1 - (4/10)*s)^(10^2/4) * ...
        0.3 / (1 - (9/14)*s)^(14^2/9) * ...
        0.3 / (1 - (9/22)*s)^(22^2/9);

W_den = 1 - 0.6 / (1 - (25/23)*s)^(23^2/25) - ...
        0.2 / (1 - (16/37)*s)^(37^2/16) * ...
        0.7 / (1 - (16/37)*s)^(37^2/16) * ...
        1.0 / (1 - (9/17)*s)^(17^2/9);

W_E = W_num / W_den;

% Аппроксимация рядом Тейлора (до 5-го порядка для скорости)
taylor_order = 5;
W_E_taylor = taylor(W_E, s, 0, 'Order', taylor_order);

% Коэффициенты ряда Тейлора
coeffs = sym2poly(W_E_taylor);
moments = coeffs(2:end) .* factorial(1:taylor_order-1);

% Математическое ожидание и дисперсия
M = moments(1);
D = moments(2) - M^2;

disp('Математическое ожидание:');
disp(double(M));
disp('Дисперсия:');
disp(double(D));
disp('Начальные моменты (μ₁-μ₅):');
disp(double(moments));
