pkg load symbolic
syms s

% Параметры дуг (из таблицы)
p_1_2 = 0.7;  M_1_2 = 37;  D_1_2 = 16;
p_1_3 = 0.3;  M_1_3 = 10;  D_1_3 = 4;
p_2_4 = 1.0;  M_2_4 = 17;  D_2_4 = 9;
p_3_3 = 0.6;  M_3_3 = 23;  D_3_3 = 25;
p_3_4 = 0.1;  M_3_4 = 53;  D_3_4 = 36;
p_3_5 = 0.3;  M_3_5 = 14;  D_3_5 = 9;
p_4_1 = 0.2;  M_4_1 = 37;  D_4_1 = 16;
p_4_6 = 0.8;  M_4_6 = 42;  D_4_6 = 9;
p_5_2 = 0.7;  M_5_2 = 35;  D_5_2 = 4;
p_5_6 = 0.3;  M_5_6 = 22;  D_5_6 = 9;

% Упрощенная W_E(s) через MGF гамма-распределения
W_num = p_1_2 * (1/(1 - (D_1_2/M_1_2)*s))^(M_1_2^2/D_1_2) * ...
        p_2_4 * (1/(1 - (D_2_4/M_2_4)*s))^(M_2_4^2/D_2_4) * ...
        p_4_6 * (1/(1 - (D_4_6/M_4_6)*s))^(M_4_6^2/D_4_6) + ...
        p_1_3 * (1/(1 - (D_1_3/M_1_3)*s))^(M_1_3^2/D_1_3) * ...
        p_3_5 * (1/(1 - (D_3_5/M_3_5)*s))^(M_3_5^2/D_3_5) * ...
        p_5_6 * (1/(1 - (D_5_6/M_5_6)*s))^(M_5_6^2/D_5_6);

W_den = 1 - p_3_3 * (1/(1 - (D_3_3/M_3_3)*s))^(M_3_3^2/D_3_3) - ...
        p_4_1 * (1/(1 - (D_4_1/M_4_1)*s))^(M_4_1^2/D_4_1) * ...
        p_1_2 * (1/(1 - (D_1_2/M_1_2)*s))^(M_1_2^2/D_1_2) * ...
        p_2_4 * (1/(1 - (D_2_4/M_2_4)*s))^(M_2_4^2/D_2_4);

W_E = W_num / W_den;

% Численное вычисление моментов через разложение в ряд Тейлора
s_values = 0:0.01:0.1; % Малое приращение s
W_E_values = double(subs(W_E, s, s_values));
coefficients = polyfit(s_values, W_E_values, 10); % Полином 10-й степени

% Начальные моменты (коэффициенты разложения)
moments = factorial(0:10) .* coefficients(end:-1:1);

% Вывод первых 10 моментов
disp('Начальные моменты (μ₁-μ₁₀):');
disp(moments(2:11)); % μ₁ соответствует коэффициенту при s^1
